(function(c){var d=window.AmazonUIPageJS||window.P,f=d._namespace||d.attributeErrors,b=f?f("DigitalMusicWebsitePromoCodeAssets"):d;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,d,f){(function(){c.when("A","a-modal").register("dmusic_webstore_promo_code",function(b,c){function d(g){a.ajax({url:"/gp/dmusic/purchase/utility/promoHelper.html",data:{},type:"GET",dataType:"json",cache:!1,success:function(a){"undefined"!==typeof e&&e||(e={});e.promotionBalances=a;
g(1)},failure:function(a){g(0)}})}function f(g,b){a.ajax({url:"/gp/dmusic/purchase/utility/promoHelper.html",data:{operation:"redeemCode",code:g},type:"POST",dataType:"json",cache:!1,success:function(a){b(a.success)},failure:function(a){b(a.success)}})}function h(){d(function(b){a("#gc_promo_spinner").hide(function(){b?(a("#pGiftCardBalanceAmount").text(e.promotionBalances.AMAZON_GIFT_CARD),a("#pMP3BalanceAmount").text(e.promotionBalances.AMAZON_MP3)):(a("#errorBoxRetreive").removeClass("aok-hidden"),
a("#errorBoxApply").addClass("aok-hidden"),a("#successBox").addClass("aok-hidden"));a("#gc_promo_spinner").hide();a("#gc_promo_balances").show()})})}var a=b.$,e={};return{promoBox:{setup:function(){a(".promoBoxApply").click(function(){a("#gc_promo_balances").hide(function(){a("#gc_promo_spinner").show(function(){var b=a("#GCCodeEntry").val();f(b,function(b){b?(a("#GCCodeEntry").val(""),a("#successBox").removeClass("aok-hidden"),a("#errorBoxApply").addClass("aok-hidden"),a("#errorBoxRetreive").addClass("aok-hidden"),
h()):(a("#errorBoxApply").removeClass("aok-hidden"),a("#errorBoxRetreive").addClass("aok-hidden"),a("#successBox").addClass("aok-hidden"),a("#gc_promo_spinner").hide(),a("#gc_promo_balances").show())})})})});a(".promoBoxCancel").click(function(){c.get(a("#promoBoxModal")).hide()});h()}}}})})()});